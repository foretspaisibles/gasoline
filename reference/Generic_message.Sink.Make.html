<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="Up" href="Generic_message.Sink.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Unicode" rel="Chapter" href="Unicode.html">
<link title="SysExits" rel="Chapter" href="SysExits.html">
<link title="Getopt" rel="Chapter" href="Getopt.html">
<link title="ConfigurationMap" rel="Chapter" href="ConfigurationMap.html">
<link title="Generic_component" rel="Chapter" href="Generic_component.html">
<link title="Generic_type" rel="Chapter" href="Generic_type.html">
<link title="Generic_message" rel="Chapter" href="Generic_message.html">
<link title="Generic_diagnostic" rel="Chapter" href="Generic_diagnostic.html">
<link title="Generic_asset" rel="Chapter" href="Generic_asset.html">
<link title="Generic_application" rel="Chapter" href="Generic_application.html">
<link title="CType" rel="Chapter" href="CType.html">
<link title="CConfigurationMap" rel="Chapter" href="CConfigurationMap.html">
<link title="CMessage" rel="Chapter" href="CMessage.html">
<link title="CApplication" rel="Chapter" href="CApplication.html">
<link title="ConfigurationParser" rel="Chapter" href="ConfigurationParser.html">
<link title="UnitTest" rel="Chapter" href="UnitTest.html">
<link title="WSGML" rel="Chapter" href="WSGML.html">
<link title="WHTML" rel="Chapter" href="WHTML.html">
<link title="LoremIpsum" rel="Chapter" href="LoremIpsum.html"><title>Gasoline library : Generic_message.Sink.Make</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="Generic_message.Sink.html" title="Generic_message.Sink">Up</a>
&nbsp;</div>
<h1>Functor <a href="type_Generic_message.Sink.Make.html">Generic_message.Sink.Make</a></h1>

<pre><span class="keyword">module</span> Make <code class="code">(</code><code class="code">P</code><code class="code"> : </code><code class="type"><a href="Generic_message.P.html">Generic_message.P</a></code><code class="code">) </code>: <code class="type"><a href="Generic_message.Sink.S.html">S</a></code><code class="type"> 
    with type classification = P.Classification.t
    and type locale = P.Locale.t
    and type connection_token = P.Database.connection_token
    and type out_channel = P.Data.out_channel
    and type value = P.Value.t</code></pre><table border="0" cellpadding="3" width="100%">
<tr>
<td align="left" valign="top" width="1%%"><b>Parameters: </b></td>
<td>
<table class="paramstable">
<tr>
<td align="center" valign="top" width="15%">
<code>P</code></td>
<td align="center" valign="top">:</td>
<td><code class="type"><a href="Generic_message.P.html">Generic_message.P</a></code>
</table>
</td>
</tr>
</table>
<hr width="100%">

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type"></code>t</span> </pre>
<div class="info ">
The type of message sinks.<br>
</div>


<pre><span id="VALcreate"><span class="keyword">val</span> create</span> : <code class="type">unit -> <a href="Generic_message.Sink.S.html#TYPEt">t</a></code></pre><div class="info ">
Create a message sink.
<p>

    To become fully operational, a message sink must be connected to a
    (locale,databank) pair with <code class="code">connect</code> below, and attached to one
    or more output channel with <code class="code">attach</code> below.
<p>

    A sink that is not connected to a locale and a databank behaves as
    if the control bit delay were set.
<p>

    A sink that is conencted to a locale and a databank but is not
    attached to any output channel nehaves as if the drop bit were
    set.<br>
</div>

<pre><span id="TYPEclassification"><span class="keyword">type</span> <code class="type"></code>classification</span> </pre>
<div class="info ">
The type of message classifications.<br>
</div>


<pre><span id="TYPEconnection_token"><span class="keyword">type</span> <code class="type"></code>connection_token</span> </pre>
<div class="info ">
The type of message database connection tokens.<br>
</div>


<pre><span id="TYPEout_channel"><span class="keyword">type</span> <code class="type"></code>out_channel</span> </pre>
<div class="info ">
The type of output channels.<br>
</div>


<pre><span id="TYPEvalue"><span class="keyword">type</span> <code class="type"></code>value</span> </pre>
<div class="info ">
The type of variable values that can occur in a message.<br>
</div>


<pre><span id="TYPElocale"><span class="keyword">type</span> <code class="type"></code>locale</span> </pre>
<div class="info ">
The type of locales.<br>
</div>


<pre><code><span id="TYPEcontrol"><span class="keyword">type</span> <code class="type"></code>control</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span class="keyword">mutable&nbsp;</span><span id="TYPEELTcontrol.async">async</span>&nbsp;: <code class="type">bool</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Buffer messages</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span class="keyword">mutable&nbsp;</span><span id="TYPEELTcontrol.delay">delay</span>&nbsp;: <code class="type">bool</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Delay messages</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span class="keyword">mutable&nbsp;</span><span id="TYPEELTcontrol.drop">drop</span>&nbsp;: <code class="type">bool</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Drop messages</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span class="keyword">mutable&nbsp;</span><span id="TYPEELTcontrol.cap">cap</span>&nbsp;: <code class="type"><a href="Generic_message.Sink.S.html#TYPEclassification">classification</a> option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Cap messages</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span class="keyword">mutable&nbsp;</span><span id="TYPEELTcontrol.floor">floor</span>&nbsp;: <code class="type"><a href="Generic_message.Sink.S.html#TYPEclassification">classification</a> option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Floor messages</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
The type of message sink control bits.
<p>

    A message sink operating with the <code class="code">async</code> bit set never flushes
    implicitly its backend, otherwise it flushes its backend after each
    emission.
<p>

    A message sink operating with the <code class="code">delay</code> bit set does not emit the
    messages it receives but gather them in an internal storage. These
    messages can later be emitted or discarded, see <code class="code">proceed</code> and
    <code class="code">discard</code> below.
<p>

    A message sink operating with the <code class="code">drop</code> bit set drops every
    messagess it becomes, without actually doing anything.
<p>

    Capping (resp. flooring) messages: if a cap (resp. floor) is
    given, messages will reach the sink, only if they have a
    classification at most (resp. at least) as important as the given
    one.
<p>

    A fresh new message sink operates with all its control bits set to
    false, cap and floor set to <code class="code">None</code>.<br>
</div>


<pre><span id="VALget_control"><span class="keyword">val</span> get_control</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> <a href="Generic_message.Sink.S.html#TYPEcontrol">control</a></code></pre><div class="info ">
Return the control bits of a message sink.
<p>

    The bits are mutable and can then be edited.<br>
</div>

<pre><span id="VALconnect"><span class="keyword">val</span> connect</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -><br>       <a href="Generic_message.Sink.S.html#TYPEconnection_token">connection_token</a> -><br>       <a href="Generic_message.Sink.S.html#TYPElocale">locale</a> -> unit</code></pre><div class="info ">
Connect a message sink with a databank. A previous
    connection, if any, is closed.
<p>

    After connection, pending messages are proceeded, as if the
    <code class="code">proceed</code> procedure below had been called.<br>
</div>

<pre><span id="VALdisconnect"><span class="keyword">val</span> disconnect</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Disconnect the message sink from its databank.<br>
</div>

<pre><span id="VALis_connected"><span class="keyword">val</span> is_connected</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> bool</code></pre><div class="info ">
Predicate recognising connected sinks.<br>
</div>

<pre><span id="VALattach"><span class="keyword">val</span> attach</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> <a href="Generic_message.Sink.S.html#TYPEout_channel">out_channel</a> -> unit</code></pre><div class="info ">
Attach an output channel to a sink.<br>
</div>

<pre><span id="VALdetach"><span class="keyword">val</span> detach</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Detach all output channels from a sink.<br>
</div>

<pre><span id="VALiter"><span class="keyword">val</span> iter</span> : <code class="type">(<a href="Generic_message.Sink.S.html#TYPEout_channel">out_channel</a> -> unit) -><br>       <a href="Generic_message.Sink.S.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Iter over output channels attached to a sink.
<p>

    It is an error to close output channels attached to a sink.<br>
</div>

<pre><span id="VALout_channels"><span class="keyword">val</span> out_channels</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> <a href="Generic_message.Sink.S.html#TYPEout_channel">out_channel</a> list</code></pre><div class="info ">
The list of output channels attached to our sink.<br>
</div>

<pre><span id="VALsend"><span class="keyword">val</span> send</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -><br>       <a href="Generic_message.Sink.S.html#TYPEclassification">classification</a> -><br>       string -> (string * <a href="Generic_message.Sink.S.html#TYPEvalue">value</a>) list -> unit</code></pre><div class="info ">
<code class="code">send s c id binding</code> ask the sink <code class="code">s</code> to send the
    message identified by <code class="code">id</code> with classification <code class="code">c</code>, substituting
    message variables according to the <code class="code">binding</code>.<br>
<b>Raises</b><ul><li><code>Variable_not_found</code> to indicate a variable occuring
      in the message that is not bound in the <code class="code">binding</code>.</li>
<li><code>Message_not_found</code> to indicate the concrete form
      corresponding to <code class="code">id</code> on the message.</li>
<li><code>Invalid_message</code> to indicate an invalid concrete form
      for the message. The concrete form is given as argument to the
      error constructor and may be analysed with the lexer to find the
      precise origin of the error.</li>
</ul>
</div>

<pre><span id="VALsync"><span class="keyword">val</span> sync</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Require a sink to process all pending messages and to flush
    its backend.
<p>

    On a non connected sink, this is a no-op.<br>
</div>

<pre><span id="VALflush"><span class="keyword">val</span> flush</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Another name for sync.<br>
</div>

<pre><span id="VALproceed"><span class="keyword">val</span> proceed</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Another name for sync.<br>
</div>

<pre><span id="VALdiscard"><span class="keyword">val</span> discard</span> : <code class="type"><a href="Generic_message.Sink.S.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
Require a sink to discard all pending messages.<br>
</div>
</body></html>